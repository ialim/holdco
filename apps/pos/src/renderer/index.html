<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>HoldCo POS</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div id="app">
      <header class="app-header">
        <div>
          <p class="kicker">HoldCo POS</p>
          <h1>Retail Console</h1>
          <p class="sub">Offline-first device and shift management.</p>
        </div>
        <div class="header-actions">
          <span id="apiStatus" class="status-pill">Offline</span>
          <button id="checkHealth" class="ghost">Check API</button>
          <button id="navShift" class="ghost">Shift</button>
          <button id="navCheckout" class="ghost">Checkout</button>
          <button id="navSignOut" class="ghost">Sign out</button>
          <button id="flushQueue" class="primary">Flush Queue</button>
        </div>
      </header>

      <div id="offlineBanner" class="banner hidden">Offline: queued operations only.</div>
      <div class="status-bar">
        <div class="status-left">
          <div class="status-item">
            <span class="label">Device token</span>
            <span id="deviceTokenStatus" class="status-pill">Missing</span>
            <span id="deviceTokenExpiry" class="mono"></span>
          </div>
          <div class="status-item">
            <span class="label">Shift</span>
            <span id="shiftBannerStatus" class="status-pill">Closed</span>
            <span id="shiftBannerDetail" class="mono"></span>
          </div>
        </div>
        <div class="status-right">
          <div class="status-item">
            <span class="label">Queue</span>
            <span id="queueCount" class="mono">0</span>
          </div>
        </div>
      </div>

      <main>
        <section id="viewLoading" class="view active">
          <div class="card splash">
            <div class="spinner"></div>
            <h2>Loading POS configuration</h2>
            <p class="helper">Checking device provisioning and token status.</p>
          </div>
        </section>

        <section id="viewConfigMissing" class="view">
          <div class="card">
            <h2>Device not provisioned</h2>
            <p class="helper">Provision the device in Admin-Ops and ensure config.json is present.</p>
            <div id="configMissingMessage" class="helper error"></div>
            <div class="actions">
              <button id="reloadConfigMissing" class="primary">Reload config</button>
            </div>
          </div>
        </section>

        <section id="viewActivation" class="view">
          <div class="grid">
            <div class="card">
              <div class="card-header">
                <h2>Configuration</h2>
                <button id="reloadConfig" class="ghost">Reload</button>
              </div>
              <div id="configStatus" class="helper"></div>
              <div class="config-grid">
                <div>
                  <label>API Base</label>
                  <div id="configApi" class="mono"></div>
                </div>
                <div>
                  <label>Group</label>
                  <div id="configGroup" class="mono"></div>
                </div>
                <div>
                  <label>Subsidiary</label>
                  <div id="configSubsidiary" class="mono"></div>
                </div>
                <div>
                  <label>Location</label>
                  <div id="configLocation" class="mono"></div>
                </div>
                <div>
                  <label>Channel</label>
                  <div id="configChannel" class="mono"></div>
                </div>
                <div>
                  <label>Device ID</label>
                  <div id="configDevice" class="mono"></div>
                </div>
              </div>
              <pre id="configRaw"></pre>
            </div>

            <div class="card">
              <div class="card-header">
                <h2>Manager Activation</h2>
              </div>
              <form id="managerActivateForm" class="stack">
                <div class="form-row">
                  <label for="managerEmployeeNo">Manager Employee No</label>
                  <input id="managerEmployeeNo" type="text" placeholder="MGR-001" required />
                </div>
                <div class="form-row">
                  <label for="managerPin">Manager PIN</label>
                  <input id="managerPin" type="password" inputmode="numeric" required />
                </div>
                <button type="submit" class="primary">Activate Device</button>
              </form>
              <div id="managerInfo" class="info-panel"></div>
              <div class="helper">Activation refreshes the device token for 24 hours.</div>
            </div>

            <div class="card">
              <div class="card-header">
                <h2>Device</h2>
                <button id="refreshDevice" class="ghost">Refresh</button>
              </div>
              <div class="helper">Provision devices in Admin-Ops.</div>
              <div id="deviceInfo" class="info-panel"></div>
            </div>
          </div>
        </section>

        <section id="viewCashier" class="view">
          <div class="grid">
            <div class="card">
              <div class="card-header">
                <h2>Cashier</h2>
                <div class="header-actions">
                  <span id="cashierStatus" class="status-pill">Signed out</span>
                  <button id="cashierLogout" class="ghost">Sign out</button>
                </div>
              </div>
              <form id="cashierLoginForm" class="stack">
                <div class="form-row">
                  <label for="cashierEmployeeNo">Employee No</label>
                  <input id="cashierEmployeeNo" type="text" placeholder="EMP-001" required />
                </div>
                <div class="form-row">
                  <label for="cashierPin">PIN</label>
                  <input id="cashierPin" type="password" inputmode="numeric" required />
                </div>
                <button type="submit" class="primary">Sign in</button>
              </form>
              <div id="cashierInfo" class="info-panel"></div>
              <div class="helper">Cashier JWT is sent via <span class="mono">X-Cashier-Token</span>.</div>
            </div>
          </div>
        </section>

        <section id="viewShift" class="view">
          <div class="grid">
            <div class="card">
              <div class="card-header">
                <h2>Shift</h2>
                <button id="refreshShift" class="ghost">Refresh</button>
              </div>
              <div id="shiftInfo" class="info-panel"></div>
              <form id="openShiftForm" class="stack">
                <div class="form-row">
                  <label for="openingFloat">Opening float</label>
                  <input id="openingFloat" type="number" min="0" step="0.01" />
                </div>
                <div class="form-row">
                  <label for="openNotes">Notes</label>
                  <input id="openNotes" type="text" />
                </div>
                <button type="submit" class="primary">Start Shift</button>
              </form>
              <form id="closeShiftForm" class="stack">
                <div class="form-row">
                  <label for="closingFloat">Closing float</label>
                  <input id="closingFloat" type="number" min="0" step="0.01" />
                </div>
                <div class="form-row">
                  <label for="closeNotes">Notes</label>
                  <input id="closeNotes" type="text" />
                </div>
                <button type="submit" class="danger">Close Shift</button>
              </form>
            </div>
          </div>
          <div class="actions">
            <button id="proceedCheckout" class="primary">Proceed to Checkout</button>
          </div>
        </section>

        <section id="viewCheckout" class="view">
          <div class="checkout-stack">
            <div class="card checkout checkout-full">
              <div class="card-header">
                <h2>Checkout</h2>
                <button id="searchProducts" class="ghost">Search</button>
              </div>
              <div class="form-row">
                <label for="productSearch">Product search</label>
                <input id="productSearch" type="text" placeholder="Search by name or SKU" />
              </div>
              <div id="productResults" class="list"></div>

              <div class="divider"></div>

              <h3>Cart</h3>
              <div id="cartItems" class="cart"></div>
              <div class="cart-summary">
                <div>Items: <span id="cartCount">0</span></div>
                <div>Total: <span id="cartTotal">0.00</span></div>
              </div>
              <div class="form-row">
                <label for="orderCurrency">Currency</label>
                <input id="orderCurrency" type="text" maxlength="3" value="NGN" />
              </div>
              <div class="form-row">
                <label for="orderNotes">Notes</label>
                <input id="orderNotes" type="text" />
              </div>
              <div class="actions">
                <button id="submitOrder" class="primary">Submit Order</button>
                <button id="clearCart" class="ghost">Clear Cart</button>
              </div>
              <div id="orderStatus" class="helper"></div>
            </div>

            <div class="card queue-card">
              <div class="card-header">
                <h2>Offline Queue</h2>
                <button id="refreshQueue" class="ghost">Refresh</button>
              </div>
              <div id="queueSummary" class="helper"></div>
              <pre id="queueOutput"></pre>
            </div>
          </div>
        </section>
      </main>
    </div>

    <div id="toast" class="toast"></div>
    <script src="app.js"></script>
  </body>
</html>
